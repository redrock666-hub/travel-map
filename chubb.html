<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>å®‰é”ç”¢ç«¶è³½çå‹µåœ°åœ–</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <style>
    html, body, #map {
      height: 100%;
      margin: 0;
      padding: 0;
    }
    .my-div-icon {
      background-color: #f5a623;
      border-radius: 50%;
      color: #fff;
      font-size: 60px;
      width: 70px;
      height: 70px;
      line-height: 70px;
      text-align: center;
      border: 3px solid #fff;
      box-shadow: 0 0 15px rgba(0,0,0,0.8);
      font-weight: bold;
    }
    .my-div-icon span {
      color: #003366;
      font-weight: bold;
      font-size: 64px;
    }
    .trophy-icon {
      font-size: 64px;
      text-shadow: 2px 2px 4px rgba(0,0,0,0.4);
    }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script>
    const map = L.map('map').setView([24.85, 121.6], 9);
    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '&copy; OpenStreetMap contributors'
    }).addTo(map);

    const itinerary = [
      {
        title: "ä¾†å›åŒ—è»Šå¤©æˆ",
        coords: [24.68214503429983, 121.77604450465122],
        note: "ğŸ“… 4æœˆ12æ—¥ï¼ˆæ˜ŸæœŸå…­ï¼‰è¡Œç¨‹<br>08:30 åŒ—è»Šå¤©æˆé–€å£é›†åˆä¸Šè»Š<br><br>ğŸ“… 4æœˆ13æ—¥ï¼ˆæ˜ŸæœŸæ—¥ï¼‰è¡Œç¨‹<br>16:00 æŠµé”åŒ—è»Šå¤©æˆ",
        label: "0"
      },
      {
        title: "ä¸­èˆˆæ–‡å‰µåœ’å€",
        coords: [24.678683, 121.772835],
        note: "ğŸ“… 4æœˆ12æ—¥ï¼ˆæ˜ŸæœŸå…­ï¼‰è¡Œç¨‹<br>10:30 æŠµé”ä¸­èˆˆæ–‡å‰µåœ’å€<br>10:40 ~ 11:30 åˆ†çµ„æ´»å‹•",
        label: "1"
      },
      {
        title: "åˆé¤",
        coords: [24.681221, 121.766688],
        note: "ğŸ“… 4æœˆ12æ—¥ï¼ˆæ˜ŸæœŸå…­ï¼‰è¡Œç¨‹<br>11:50 ~ 13:30 ç¾…æ±ç¥¥ç‘æ»¬å°æœˆé¤å»³",
        label: "2"
      },
      {
        title: "ç²¾å½©ä¸»é¡Œ",
        coords: [24.677111, 121.765833],
        note: "ğŸ“… 4æœˆ12æ—¥ï¼ˆæ˜ŸæœŸå…­ï¼‰è¡Œç¨‹<br>13:40 ~ 13:50 å‰å¾€æ‘å»åœ‹éš›æº«æ³‰é…’åº—<br>14:00 ~ 16:00 Team Building <br>16:00 ~ 16:15 ç™¼æ”¾æˆ¿å¡ã€æ˜Ÿç©ºé…’å§èªªæ˜ã€é€²æˆ¿æª¢æŸ¥<br>16:15 ~ 17:45 è‡ªç”±æ´»å‹•<br>17:45 ~ 17:50 é¤å»³é›†åˆ + å¤§åˆç…§<br>18:00 ~ 21:00 æ™šå®´æš¨é ’çæ´»å‹•ï¼ˆæ­¡å”±å¡å•¦OKï¼‰<br>21:10 ~ æˆ¿é–“æ³¡æ¹¯æˆ–çœ‹å¤œæ™¯<br><br>ğŸ“… 4æœˆ13æ—¥ï¼ˆæ˜ŸæœŸæ—¥ï¼‰è¡Œç¨‹<br>06:30 ~ 10:30 é£¯åº—è‡ªåŠ©æ—©é¤<br>07:05 ~ 10:50 è‡ªç”±æ´»å‹• - ä½¿ç”¨é£¯åº—è¨­æ–½<br>10:55 ~ 11:00 é€€æˆ¿",
        label: "3"
      },
      {
        title: "åˆé¤ã€è³¦æ­¸",
        coords: [24.68432, 121.768802],
        note: "ğŸ“… 4æœˆ13æ—¥ï¼ˆæ˜ŸæœŸæ—¥ï¼‰è¡Œç¨‹<br>11:30 ~ 13:30 åˆé¤ - ç¾…æ±æ™¶åœ’æœƒé¤¨<br>13:40 è³¦æ­¸å›åŒ—è»Šå¤©æˆ",
        label: "4"
      },
      {
        title: "ä¾†å›åŒ—è»Šå¤©æˆ",
        coords: [24.68214503429983, 121.77604450465122],
        note: "ğŸ“… 4æœˆ12æ—¥ï¼ˆæ˜ŸæœŸå…­ï¼‰è¡Œç¨‹<br>08:30 åŒ—è»Šå¤©æˆé–€å£é›†åˆä¸Šè»Š<br><br>ğŸ“… 4æœˆ13æ—¥ï¼ˆæ˜ŸæœŸæ—¥ï¼‰è¡Œç¨‹<br>16:00 æŠµé”åŒ—è»Šå¤©æˆ",
        label: "0"
      },
    ];

    const polylinePoints = itinerary.map(item => item.coords);

    itinerary.forEach((item) => {
      const popupContent = `<div><strong>${item.label}. ${item.title}</strong><br>${item.note}</div>`;
      L.marker(item.coords, {
        icon: L.divIcon({
          className: 'my-div-icon',
          html: `<span>${item.label}</span><div style='font-size:12px;'>${item.title}</div>`
        })
      }).addTo(map).bindPopup(popupContent);
    });

    const polyline = L.polyline(polylinePoints, { color: 'red' }).addTo(map);
    map.fitBounds(polyline.getBounds(), { padding: [30, 30] });

    const trophyIcon = L.divIcon({
      html: '<div class="trophy-icon">ğŸ†</div>',
      className: '',
      iconSize: [64, 64],
      iconAnchor: [32, 32]
    });

    let trophyMarker = L.marker(polylinePoints[0], { icon: trophyIcon }).addTo(map);

    let index = 0;
    function animateTrophy() {
      const nextIndex = (index + 1) % polylinePoints.length;
      const current = polylinePoints[index];
      const next = polylinePoints[nextIndex];
      let steps = 100;
      let step = 0;
      const latDelta = (next[0] - current[0]) / steps;
      const lngDelta = (next[1] - current[1]) / steps;

      const move = () => {
        if (step < steps) {
          let lat = current[0] + latDelta * step;
          let lng = current[1] + lngDelta * step;
          trophyMarker.setLatLng([lat, lng]);
          step++;
          requestAnimationFrame(move);
        } else {
          index = nextIndex;
          setTimeout(animateTrophy, 500);
        }
      };
      move();
    }

    animateTrophy();
  </script>
</body>
</html>
